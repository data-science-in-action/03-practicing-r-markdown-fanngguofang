---
title: "Approximation of the Distribution"
author: "Fang Guo"
date: "2020/3/22"
output:
  #pdf_document: default
  #bookdown::pdf_document2
  bookdown::html_document2
fontsize: 11pt
keywords: Monte Carlo, R Markdown, bookdown
documentclass: article
papersize: letter
abstract: "This report complete approximation of the distribution fuction \nof $N(0,1)$
  by the Monte Carlo methods. By writing this report, \ni learn most common components
  of a single R Markdown document, \nlike forming a table, math equation and so on.\n"
---
# Introduction {#sec:intro}

  This report complete approximation of the distribution fuction of
$N(0,1)$ by the Monte Carlo methods. By writing this report, i have
learned a template in R Markdown. I know most of the basic syntax 
of writing a single R Markdown document.

The rest of this report is organised as follows: In Section 
\@ref(sec:math) , i give some mathematical equations about 
this problem. The generation of tables and other R objects is 
dispalyed in Section \@ref(sec:resu). And a brief demonstration 
of a code chunk is gave in this Section. At last but not least, 
i give a brief explaination of resluts in last section.

# Math Equations {#sec:math}

In this problem, i consider approximation the distribution
function of  $N(0,1)$ , 
\begin{align}
    \Phi(t) = \int_{-\infty}^t\frac{1}{\sqrt{{2\pi}}}e^
     {(-y^2)/2} \,{\rm d}y,
\end{align}
by the Monte Carlo methods:
\begin{align}
    \hat{\Phi}(t) = \frac{1}{n}\sum_{i=1}^n I(X_i \leq t),
\end{align}
where $X_i$ is a random sample from $N(0,1)$, and $I(.)$ is 
the indicator function.

# Results  {#sec:resu}

I experiment with the approximation at $n \in \lbrace10^2,10^3,10^4\rbrace$ 
at $t \in \lbrace0.0,0.67,0.84,1.28,1.65,2.32,2.58,3.09,3.72\rbrace$
to form a table. At the same time, the table include the 
true value for comparison. It can be generated by the following R 
code chunk. The resulting table is shown in table \@ref(tab:norm). 

(ref:norm) The table of approximation results.

```{r norm, echo = TRUE }
t=c(0,0.67,0.84,1.28,1.65,2.32,2.58,3.09,3.72)
n=c(100,1000,10000)
p=matrix(0,nrow=9,ncol=3)
#a=0
for (i in 1:9)
  for(j in 1:3){
    #a=a+1
    num=rnorm(n[j],0,1)
    p[i,j]=mean(num<t[i])
    #print(a)
  }
rownames(p)<-t
colnames(p)<-n
true_value<-c(pnorm(0),pnorm(0.67),pnorm(0.84),pnorm(1.28),pnorm(1.65),
           pnorm(2.32),pnorm(2.58),pnorm(3.09),pnorm(3.72))
p<-cbind(p,true_value)
p<-round(p,digits=3)
#make figure more beautiful
library(knitr)
library(magrittr)
library(kableExtra)
kable(p, booktabs=TRUE, caption='(ref:norm)') %>%
  kable_styling(bootstrap_options = "striped",full_width = F) %>% 
 column_spec(1,bold=T)#full_width=F, is or isn't full of screen

```

Further, repeat the experiment 100 times. Draw box plots of the 100
approximation errors at each $t$ using ggplot2 for each $n$. Figure
\@ref(fig:error) is the resulting plot. Because the 
codes generated following box plots are too much, so it just show the part of 
codes. These code can generate the top three image. I just put other codes in 
another file. If you are interested in it. You can read it in the file named "code".

```{r ,echo = T,eval=FALSE}
p1<-ggplot(data=plot_data,aes(y=V1,x=label1))+geom_boxplot(
  fill="thistle",colour="gray27")+
  labs(title="Boxplot of error at t=0, n=100",y="error",
       x=NULL)+theme(plot.title=element_text(size=13,hjust=0.5))
      #theme(hjust)=0.5
p2<-ggplot(data=plot_data,aes(y=V2,x=label2))+geom_boxplot(
  fill="thistle",colour="gray27")+
  labs(title="Boxplot of error at t=0, n=1000",y="error",
       x=NULL)+theme(plot.title=element_text(size=13,hjust=0.5))
p3<-ggplot(data=plot_data,aes(y=V3,x=label3))+geom_boxplot(
  fill="thistle",colour="gray27")+
  labs(title="Boxplot of error at t=0, n=10000",y="error",
       x=NULL)+theme(plot.title=element_text(size=13,hjust=0.5))
g1<-multiplot(p1,p2,p3,cols=3)

```

(ref:cap-error) The boxplots of errors
```{r error,echo = T,eval = TRUE, fig.cap = "(ref:cap-error)",out.width = '50%', fig.show = 'hold'}
#out.width = '50%', fig.show = 'hold'-plots were placed side by side
knitr::include_graphics(c("img/plot1(t=0).png","img/plot2(t=0.67).png",
                          "img/plot3(t=0.84).png","img/plot4(t=1.28).png",
                          "img/plot5(t=1.65).png","img/plot6(t=2.32).png",
                          "img/plot7(t=2.58).png","img/plot8(t=3.09).png",
                          "img/plot9(t=3.72).png"),dpi=1)
```

# Explaination {#sec:explain}

In the section \@ref(sec:resu), i generete one table to describe the 
difference between approximation and true value. It shows the error is
decreasing as the number of samples become larger. And in figure 
\@ref(fig:error), this inclusion is proved once again. At the same time, 
we could see when number of samples expand, the extremum is decreasing.
Especially, when t=3.09, n=100 or t=3.72, n=100, 1000, the errors are almost 0.

# Acknowledgment 

I would like to thank all teachers, especially Professor Jun Yan. Without this class, i would not to learn this thing by myself.


